"use strict";function doOnLoad(e){(category=new dhtmlXTreeObject("treeboxbox_tree","100%","100%",0)).setImagePath("/"+ADMIN_DIR+"/images/tree/"),category.enableDragAndDrop(!0),category.setEditStartAction(1/0),category.enableKeyboardNavigation(!0),category.enableMultiselection(!0),category.enableTreeLines(!0),category.makeAllDraggable(),category.attachEvent("onDrop",function(t,n,a,i,o){$.ajax({url:"/"+ADMIN_DIR+"/"+e+"/updateStructure",type:"post",data:{oid:t,pid:n}})}),category.attachEvent("onDblClick",function(e){})}function controlLink(e,t,n,a,i){switch(n){case"add":return'<a href="/'+ADMIN_DIR+"/"+e+"/"+t+"/add/"+a+'" class="control-icon icon icon-file-plus" title="Добавить подраздел" data-no-instant></a>';case"edit":return'<a href="/'+ADMIN_DIR+"/"+e+"/"+t+"/edit/"+a+'" class="control-icon icon icon-edit" title="Редактировать раздел" data-no-instant></a>';case"visible":return'<a href="/'+ADMIN_DIR+"/"+e+"/"+t+"/visible/"+a+'" class="control-icon icon icon-eye'+(0==i?"-off":"")+'" onclick="ajax_vis_toggle(this, 15, 0); return false;" title="Отображение страницы" data-no-instant></a>';case"delete":return'<a href="/'+ADMIN_DIR+"/"+e+"/"+t+"/del/"+a+'" class="control-icon icon icon-delete" title="Удалить раздел" onclick="return cp.dialog(\'Вы действительно хотите удалить раздел?\');" data-no-instant></a>'}}function buildTree(e,t){$.ajax({url:"/"+ADMIN_DIR+"/"+e+"/getStructure",type:"get",dataType:"JSON",success:function(n){if(category.deleteChildItems(0),n.length)for(var a in n)controls="",controls+='<span class="control-icons">',controls+=controlLink(e,t,"add",n[a].id),controls+=controlLink(e,t,"edit",n[a].id),controls+=controlLink(e,t,"visible",n[a].id,n[a].visible),controls+=controlLink(e,t,"delete",n[a].id),controls+="</span>",close=0,open=0,leaf=0,0==n[a].pid?(leaf="icon/home.svg",open="icon/home.svg",close="icon/home.svg"):1==n[a].dynamic?leaf="icon/application-code.svg":leaf="icon/file.svg",category.insertNewChild(n[a].pid,n[a].id,n[a].name+" "+controls,0,leaf,open,close);category.openOnItemAdding(!0)}})}function keyControls(){if($(".j-clipboard").length)new ClipboardJS(".j-clipboard",{text:function(e){return $(e).addClass("copied"),setTimeout(function(){$(e).removeClass("copied")},700),e.getAttribute("data-clipboard")}});$("body").on("click",".remove-trigger",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var t=this,n=$(t).attr("href");return $.post(n,function(){cp.notify("Удалено","info"),void 0!==$(t).attr("rel")&&$($(t).attr("rel")).length>0?$($(t).attr("rel")).remove():$(t).closest("tr").remove()}),!1}),$("body").on("click",".js-remove-item",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var t=this,n=$(t).attr("href");return $.post(n,function(){cp.notify("Удалено","info"),void 0!==$(t).attr("rel")&&$($(t).attr("rel")).length>0?$($(t).attr("rel")).remove():$(t).closest("tr").remove()}),!1}),$("body").on("click",".js-add-template",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var t=$(this).closest(".js-template-wrapper"),n=parseInt($(this).data("iteration")),a=$(this).data("template"),i={};void 0!==n&&(i.id=n,n+=-1,$(this).data("iteration",n)),t.append(template(a,i))}),$("body").on("keydown",".reducing-trigger",function(e){if(38==e.which||40==e.which){e.preventDefault();var t=$(this).data("reducing")||10,n=$(this).data("format"),a=parseInt($(this).val())||0,i=0;38==e.which?i=a+t:40==e.which&&(i=a-t),i<0&&(i=0),void 0!==n&&(i="?i%".replace("?i",i)),$(this).val(i)}}),$("body").on("keypress",".latin",function(e){if(/[^A-Za-z]/g.test(String.fromCharCode(e.keyCode)))return!1}),$("body").on("keypress",".integer",function(e){if([0,8,13,38,40].indexOf(e.which)<0&&(e.which<48||e.which>57))return!1}),$("body").on("keypress",".float",function(e){if([0,8,13,38,40,44,46].indexOf(e.which)<0&&(e.which<48||e.which>57))return!1})}function fileManager(){}function fullCalendar(){var e=function(e,t){$.ajax({url:"/"+ADMIN_DIR+"/meta/sheduler/delete",type:"post",data:{id:e},success:t,dataType:"json"})},t=function(e,t){$.ajax({url:"/"+ADMIN_DIR+"/meta/sheduler/edit",type:"post",data:{id:e.id,start:e.start.format(),end:e.end.format()},success:t,dataType:"json"})},n=function(e){e.removeClass("is-animated"),setTimeout(function(){e.removeClass("is-visible").remove()},350)},a=function(e,t,a){var i=$(template("tpl_schedule",t||{}));$("body").find("#schedule-popup").length||($("body").append(i),i.addClass("is-visible"),setTimeout(function(){selectize(),jscolor.install(),i.addClass("is-animated")},50),i.find("form").on("submit",function(t){t.preventDefault?t.preventDefault():t.returnValue=!1;var o=$(this);if(!o.data("is-busy")){var l=o.attr("action"),r=o.attr("method")||"post",s=o.serializeArray();return o.data("is-busy",!0),function(e,t){$.ajax({url:e.action,type:e.method,data:e.data,success:t,dataType:"json"})}({action:l,method:r,data:s},function(t){o.data("is-busy",!1),n(i),function(e,t,n){var a=Object.keys(t),i=a.length-1,o={},l=["id","group","title","item","color","types","start","end","extra","visible"];a.forEach(function(a,r){l.indexOf(a)>=0&&(o[a]=t[a]),"types"===a&&""!==t[a]&&(o[a]=t[a].split(",")),r===i&&(n?(e.fullCalendar("renderEvent",o,!0),e.fullCalendar("refetchEvents")):e.fullCalendar("updateEvent",o))})}(e,t,a)}),!1}}),i.find(".j-schedule-popup-close").on("click",function(e){e.preventDefault(),n(i)}))};if($(".fullcalendar").length){var i=moment().startOf("day"),o=(i.clone().subtract(1,"day").format("YYYY-MM-DD"),i.format("YYYY-MM-DD"),i.clone().add(1,"day").format("YYYY-MM-DD"),moment("2018-01-01").startOf("week")),l=moment("2018-01-01").endOf("week"),r={lang:"ru",height:"auto",timezone:"local",header:{left:"agendaWeek,agendaDay",right:""},eventLimit:!1,lazyFetching:!1,defaultView:"agendaWeek",defaultDate:"2018-01-01",navLinks:!0,editable:!0,droppable:!0,selectable:!0,selectHelper:!0,aspectRatio:2,allDaySlot:!1,minTime:"07:00:00",maxTime:"21:00:00",snapDuration:"00:05:00",slotDuration:"00:05:00",slotLabelFormat:"H(:mm)",schedulerLicenseKey:"GPL-My-Project-Is-Open-Source"};$(".fullcalendar").each(function(i){var s=$(this).attr("id"),c=$("#"+s),d=c.data("name"),u=$('input[name="'+d+'"]').val();r.select=function(e,t){a(c,{action:"/"+ADMIN_DIR+"/meta/sheduler/add",group:u,start:e,end:t},!0),c.fullCalendar("unselect")},r.eventRender=function(t,n){var i=null;n.on("click",function(){clearTimeout(i),i=setTimeout(function(){!function(e,t){var n=Object.keys(t),i=n.length-1,o={},l=["id","group","title","item","color","types","extra","visible"];n.forEach(function(n,r){l.indexOf(n)>=0&&(o[n]=t[n]),"types"===n&&""!==t[n]&&(o[n]=t[n].split(",")),r===i&&(o.action="/"+ADMIN_DIR+"/meta/sheduler/edit",a(e,o,!1))})}(c,t)},300)}),n.on("dblclick",function(){confirm("Удалить?")&&(clearTimeout(i),e(t.id,function(){c.fullCalendar("removeEvents",function(e){return e.id==t.id})}))})},r.eventDrop=function(e){t(e)},r.eventResize=function(e){t(e)},void 0!==eventsJson[d]&&(r.events=eventsJson[d]),$("body").on("click",".j-remove-event",function(t){t.preventDefault();var a=$(this);if(!a.data("is-busy")){a.data("is-busy",!0);var i=a.data("event"),o=a.closest(".schedule-popup");e(i,function(){c.fullCalendar("removeEvents",function(e){return e.id==i}),n(o)})}}),c.fullCalendar(r),c.fullCalendar("changeView","agendaWeek",{start:o,end:l}),c.fullCalendar("render")})}}function on_load(){if(fileManager(),fullCalendar(),$(".watch-datemask").mask("99/99/9999"),$(".watch-phonemask").mask("+ 7 (999) 999-99-99"),$(".watch-cartnumber").mask("999-999-999"),$("body").on("click",".js-size-delete",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,$(this).closest("tr").remove()}),$("body").on("click",".js-add-size",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var t=$(this).closest(".js-size-list").find("table").find("tbody"),n=parseInt($(this).data("iteration")),a=0;t.find("tr").each(function(){parseInt($(this).data("index"))>a&&(a=parseInt($(this).data("index")))}),a++,t.append(template("tpl_image_row",{index:a,button:!0,iteration:n}))}),$(".js-table-toggle").length&&($(".js-table-toggle").on("click",function(e,t){e.preventDefault?e.preventDefault():e.returnValue=!1,t?cp.tableToggle($(this).data("toggle")):cp.tableToggle($(this).data("toggle"),e)}),$('.js-table-toggle[data-toggle-init="true"]').length&&$('.js-table-toggle[data-toggle-init="true"]').trigger("click",!0)),$(".js-slider").length&&$(".js-slider").each(function(){var e=$(this).attr("id"),t=$(this).data("type"),n=$(this).data("value"),a=$(this).data("min"),i=$(this).data("max");slider(e,t,n,a,i)}),$(".js-map").length&&$(".js-map").each(function(){var e=$(this).data("element"),t=$(this).data("provider");mapConteiner(t,e)}),$(".js-redactor").length&&$(".js-redactor").each(function(){var e=$(this).attr("id"),t=$(this).data("redactor");_redactor.init(e,t)}),$(".js-editor").length&&$(".js-editor").each(function(){var e=$(this).attr("id"),t=$(this).data("editor"),n=$(this).data("hightlight");_editor.init(e,t,n)}),$("body").on("click",".js-toggle-binding",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var t=$(this);if(t.data("element").length){var n=$($(this).data("element"));t.toggleClass("on").toggleClass("off"),n.prop("readonly",!t.hasClass("on")),$('input[name="'+n.data("binding-name")+'"]').trigger("blur")}}),$(".js-binding").length&&$(".js-binding").each(function(){$(this).hasClass("js-binding-init")||binding($(this).data("binding-name"),$(this).data("binding-element"))}),$(".js-fileupload").length&&$.upload.init(),$("body").on("mouseenter",".js-structure-controll",function(e){$(this).find(".structure__control.animate").removeClass("animate")}),$("body").on("mouseleave",".js-structure-controll",function(e){$(this).find(".structure__control").addClass("animate")}),$("body").on("click",".menu-trigger",function(e){e.preventDefault(),$("#page").toggleClass("page-open");var t="visible";return $("#page").hasClass("page-open")||(t="hidden"),$("#overlay").css({visibility:t}),!1}),$("#meta_data").sortable({handle:".js-trigger-drag",pullPlaceholder:!1,bodyClass:"dragging",draggedClass:"dragged",containerSelector:"table",itemPath:"> tbody",itemSelector:"tr",placeholder:'<tr class="placeholder"/>',onDrop:function(e,t,n,a){e.removeClass("dragged").removeAttr("style"),$("body").removeClass("dragging")}}),$("body").on("mouseenter",".trigger-navigation",function(e){var t,n=$(this),a=$("#page"),i=n.attr("rel"),o="tooltip-"+n.attr("id");if(i&&!$("#"+o).length&&!a.hasClass("page-open")){var l=n.offset().top+10;(t=document.createElement("span")).id=o,t.innerHTML=i,t.className="navigation__tooltip navigation__tooltip_animate",t.style.top=l+"px",a.append(t),setTimeout(function(){$(t).removeClass("navigation__tooltip_animate")},30)}}),$("body").on("mouseleave",".trigger-navigation",function(e){var t="tooltip-"+$(this).attr("id");if($("#"+t).length){var n=$("#"+t);n.addClass("navigation__tooltip_animate"),setTimeout(function(){n.remove()},200)}}),$("body").on("click",".wrapper",function(e){$("#page").removeClass("page-open"),$("#overlay").css({visibility:"hidden"})}),$("body").on("mouseenter",".trigger-tooltip",function(e){$(this).data("xtitle",$(this).prop("title")),$(this).prop("title","")}),$("body").on("mouseleave",".trigger-tooltip",function(e){$(this).prop("title",$(this).data("xtitle")),$(this).data("xtitle","")}),$(".trigger-popover").popover(),$(".nestable-tree").length){var e=$(".nestable-tree").eq(0);if(void 0!==e.data("path")&&void 0!==e.data("group")){var t=e.data("path"),n=parseInt(e.data("group"));e.nestable({group:n,maxDepth:20,dragStop:function(e){var a,i,o;o=0,a=parseInt(e[0].id.split("-")[1]),i=parseInt(e[0].offsetParent.offsetParent.id.split("-")[1]),isNaN(i)&&(i=n),null!==e[0].nextElementSibling&&(o=parseInt(e[0].nextElementSibling.id.split("-")[1])),isNaN(a)||isNaN(i)||$.ajax({url:"/"+ADMIN_DIR+"/"+t+"/updateStructure",type:"post",data:{oid:a,pid:i,nid:o}})},afterExpand:function(e){var n=e[0].id.split("-")[1];$.removeCookie(t+"_collapse_"+n,{path:"/"})},afterCollapse:function(e){var n=e[0].id.split("-")[1];$.cookie(t+"_collapse_"+n,"1",{expires:30,path:"/"})}})}}}!function(e){e.console=e.console||{};for(var t,n,a=e.console,i={},o=function(){},l="memory".split(","),r="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");t=l.pop();)a[t]||(a[t]=i);for(;n=r.pop();)a[n]||(a[n]=o)}("undefined"==typeof window?void 0:window),function(){navigator.userAgent.toLowerCase().indexOf("chrome")}();var cp=function(e){var t,n,a=[];return{addTemplate:function(t){e("#addtemplate").find("input").attr("disabled",!1),e("#addtemplate").toggle()},addTemplateFile:function(t){var n=e("#template_name").val(),a=e("#template_file").val();e.ajax({url:"/"+ADMIN_DIR+"/ajax/structure/",type:"post",data:{act:"ajaxAddTemplate",name:n,file:a},success:function(n){if(n.length){var a=[];for(var i in n){var o=n[i],l=t==o.id?" selected":"";a.push('<option value="'+o.id+'"'+l+">"+o.name+"</option>")}e("#select_field").html('<select name="stc_tid" id="templates_list">'+a.join("")+"</select>"),selectize("#templates_list")}e("#addtemplate").find("input").attr("disabled",!0),e("#addtemplate").hide()},dataType:"JSON"})},dropdown:function(){e(".trigger-dropdown").on("click",function(){var t=e(this).data("toggle");e("#dropdown-"+t).toggle()})},cleditor:function(){void 0!==jQuery.cleditor&&e(".redactor_cleditor").cleditor()},notify:function(a,i){clearTimeout(t),e("body").find(".notify-message").length||(n=e('<div class="notify notify-message">'+a+"</div>"),e("body").append(n),setTimeout(function(){n.addClass("animate")},10)),t=setTimeout(function(){n.removeClass("animate"),setTimeout(function(){n.remove()},300)},2500)},fileChange:function(t){var n=t.value;if(n.lastIndexOf("\\"))a=n.lastIndexOf("\\")+1;else var a=n.lastIndexOf("/")+1;n=n.slice(a),e(t).closest(".file--upload").find(".file--upload-placehoder").html(n)},binding:function(t,n){e('input[name="'+t+'"]').on("keyup",function(){""!=this.value&&e('input[name="'+n+'"]').val(transliterate(this.value,URL_TRANSLATE))})},saveSettings:function(t,n){void 0!==n&&(n.preventDefault?n.preventDefault():n.returnValue=!1);var a={};return e("#settings-container-toggle-"+t).find("input, select").each(function(){var t=e(this).attr("type"),n=e(this).attr("name"),i=e(this).val();void 0!==n&&("radio"!==t&&"checkbox"!==t||!0===e(this).is(":checked"))&&(n=n.replace("SETTINGS_",""),a[n]=i)}),e.post("/"+ADMIN_DIR+"/structure/saveSettings/",{arr:a},function(e){1==e.result&&cp.notify("Сохранено","success")},"JSON"),!1},removeSettings:function(t,n){return void 0!==n&&(n.preventDefault?n.preventDefault():n.returnValue=!1),cp.dialog("Вы дейсвительно хотите удалить блок?")&&e.post("/"+ADMIN_DIR+"/structure/removeSettings/",{id:t},function(n){1==n.result&&(e("#settings-"+t).remove(),e("#breadcrumbs-"+t).remove(),e("#container-"+t).remove(),e("#emptysplash-"+t).remove())},"JSON"),!1},arrLength:function(e){var t=0;for(var n in e)e.hasOwnProperty(n)&&t++;return t},loadSettings:function(t,n,a){var i,o={1:"type",2:"item",3:"mode"},l="",r="",s=1;"type"==a?(s=1,l=t):"item"==a?(s=2,l=e("#cnt_"+o[1]+"-"+n).find("option:selected").val(),r=t):"mode"==a&&(s=3,l=e("#cnt_"+o[2]+"-"+n).find("option:selected").val(),r=t);for(var c=i=s+1;c<=4;c++)e("#block-lvl"+c+"-"+n).length>0&&e("#block-lvl"+c+"-"+n).remove();e.post("/"+ADMIN_DIR+"/structure/loadSettings/",{action:l,mode:r},function(t){if(void 0!==t&&cp.arrLength(t)>0){var a=[],l="cnt_"+o[i]+"-"+n;a.push('<div class="block-settings-select-block lvl'+i+'" id="block-lvl'+i+"-"+n+'">'),a.push('<select name="SETTINGS_'+o[i]+"_"+n+'" id="'+l+'" onchange="cp.loadSettings(this.value, '+n+", '"+o[i]+"');\">"),a.push(' <option value="" selected>Выбрать</option>');for(var r in t)a.push('<option value="'+r+'">'+t[r]+"</option>");a.push("</select>"),a.push("</div>"),e("#block-settings-select-block-"+n).append(a.join("")),selectize("#"+l)}},"JSON")},toggleModule:function(t,n){void 0!==n&&(n.preventDefault?n.preventDefault():n.returnValue=!1);var a=e(t).attr("href");return e(t).append('<i class="loading"></i>'),e.post(a,function(n){!0===n.status&&(e(t).hasClass("icon-eye-off")?e(t).removeClass("icon-eye-off").addClass("icon-eye").html(""):e(t).removeClass("icon-eye").addClass("icon-eye-off").html(""))},"JSON"),!1},toggleSettings:function(t,n){void 0!==n&&(n.preventDefault?n.preventDefault():n.returnValue=!1);var a=e(t).attr("href").substr(1);return e(t).toggleClass("block-settings-open"),e("#"+a).toggle(),!1},tableToggle:function(t,n){void 0!==n&&(n.preventDefault?n.preventDefault():n.returnValue=!1);var a=window.location.pathname.replace(/\//g,"|"),i=t+"_toogle_"+md5(a);return void 0===n?void 0===e.cookie(i)&&(e("#"+t+" th .table_hdr").removeClass("table_u").addClass("table_d"),e("#"+t+" tr:not(.th)").hide()):(e("#"+t+" th .table_hdr").toggleClass("table_u").toggleClass("table_d"),e("#"+t+" tr:not(.th)").toggle(),e("#"+t+" tr:not(.th)").is(":visible")?e.cookie(i,"show",{expires:30,path:"/"}):e.removeCookie(i,{path:"/"})),!1},tableToggleList:function(){var t=window.location.pathname.replace(/\//g,"|"),n=md5(t);e(".table-toggle-trigger").length>0&&e(".table-toggle-trigger").each(function(){var t=this.id,a=t+"_toogle_"+n;void 0!==e.cookie(a)?(e("#"+t+" th .table_hdr").addClass("table_u").removeClass("table_d"),e("#"+t+" tr:not(.th)").show()):(e("#"+t+" th .table_hdr").removeClass("table_u").addClass("table_d"),e("#"+t+" tr:not(.th)").hide())})},addBlock:function(t,n){void 0!==n&&(n.preventDefault?n.preventDefault():n.returnValue=!1);var a=10;if(e("#cont_data").find(".block-settings-order-input").length){var i=[];e("#cont_data").find(".block-settings-order-input").each(function(){i.push(e(this).find("input").val())}),i.length&&(a=i.max()+10)}return e.post("/"+ADMIN_DIR+"/structure/getNewId/",{parent:t,order:a},function(t){var n=['<tr id="settings-'+t+'">','<td class="settings-row">','<div class="settings-container clearfix">','<a href="#" onclick="return cp.removeSettings('+t+', event);" class="block-settings-link block-settings-remove"><i class="icon icon-delete"></i>Удалить блок</a>','<a href="#settings-container-toggle-'+t+'" onclick="return cp.toggleSettings(this, event);" class="block-settings-link block-settings-title block-settings-open">','<span class="block-settings-title-drop"><i class="icon icon-cog"></i></span>','<span class="block-settings-title-text">Настройки блока</span>',"</a>",'<div class="settings-container-toggle opened" id="settings-container-toggle-'+t+'">','<div class="block-settings-ln block-settings-visible clearfix">','<div class="option-group option-combo option-simple">','<label><input type="radio" name="SETTINGS_visible_'+t+'" value="1" checked="checked"><span class="option">Активен</span></label>','<label class="disallow"><input type="radio" name="SETTINGS_visible_'+t+'" value="0"><span class="option">Не активен</span></label>',"</div>","</div>",'<div class="block-settings-ln block-settings-order clearfix">','<div class="block-settings-order-input">','<input name="SETTINGS_ord_'+t+'" value="'+a+'" placeholder="Порядок">',"</div>","</div>",'<div class="block-settings-ln block-settings-select clearfix" id="block-settings-select-block-'+t+'">','<div class="block-settings-select-block lvl1" id="block-lvl1-'+t+'">','<select name="SETTINGS_type_'+t+'" id="cnt_type-'+t+'" onchange="cp.loadSettings(this.value, '+t+', \'type\');"><option value="" selected>Выбрать</option><option value="redactor">Визуальный редактор</option><option value="editor">Редактор кода</option><option value="module">Модуль</option><option value="zone">Зона</option><option value="block">Блок</option><option value="banner">Баннер</option><option value="search">Поиск</option></select>',"</div>","</div>",'<div class="block-settings-ln block-settings-system clearfix">','<div class="block-settings-system-input">','<input name="SETTINGS_system_'+t+'" value="" placeholder="Системное имя">',"</div>","</div>",'<div class="block-settings-buttons clearfix">','<a href="#" onclick="return cp.saveSettings('+t+', event);" class="button button-purple block-settings-save"><i class="icon icon-check-square"></i>Сохранить</a>',"</div>","</div>","</div>","</td>","</tr>"];e("#cont_data").find("tbody").append(n.join("")),selectize()}),!1},dialog:function(e){return confirm(e)},indexation:function(t){if(void 0!==t&&(t.preventDefault?t.preventDefault():t.returnValue=!1),cp.dialog("Начать индексацию?")){e("#indexation-good").hide(),e("#loader").fadeIn();var n="/"+ADMIN_DIR+"/search/indexer/";e.ajax({url:n,type:"get",data:{start:0},success:function(t){"good"!=t?e.get(n,{start:t}):(e("#loader").fadeOut(),e("#indexation-good").show())},error:function(e){}})}},push:function(e){a.push(e)},pop:function(){return a.pop()},length:function(){return a.length}}}(jQuery);!function(e){e.fn.timeoutClass=function(t,n){n=n||10;var a=this;setTimeout(function(){e(a).toggleClass(t)},n)},e.fn.extend({popover:function(t){this.defaults={};e.extend({},this.defaults,t);var n,a,i,o=!1,l={},r=e("#page-wrapper");return l.position=function(t){var n=0,a=(e(window).width(),0);return i=e(t).hasClass("trigger-popover")?e(t):e(t).closest(".trigger-popover"),n=i.offset().left+i.width(),a=i.offset().top+i.height()+8,{left:n,top:a}},l.hide=function(t){e(".popover.open").length?((a=e(".popover.open")).removeClass("animate"),setTimeout(function(){a.removeClass("open"),"function"==typeof t&&t.apply()},250)):"function"==typeof t&&t.apply()},r.on("click",function(t){!o&&!e(".popover.open").length||e(t.target).closest(".trigger-popover").length||e(t.target).closest(".popover").length||l.hide()}),e(window).resize(function(){l.hide()}),r.scroll(function(){!0===o&&(n+100<r.scrollTop()||n-100>r.scrollTop())&&l.hide()}),this.each(function(){e(this).on("click",function(t){t.preventDefault();var a,i=e(this).data("popover");o=!0,l.hide(function(){0==e("#popover-"+i).length?(a=e(template("tpl_"+i,{})),r.append(a)):a=e("#popover-"+i),e("#popover-"+i).hasClass("open")||(n=r.scrollTop(),a.css(l.position(t.target)),a.toggleClass("open").timeoutClass("animate"))})})})}})}(jQuery);var category,controls;!function(e){window.template=function(t,n){return null!==e.getElementById(t)?Template7.compile(e.getElementById(t).innerHTML)(n||{}):""}}(document),$(document).ready(function(){$.upload={open:function(e,t,n,a){clearInterval(uploadOpenTimeout),uploadOpenTimeout=setTimeout(function(){upload._open(e,t,n,a)},200)},clearErrors:function(e){e.find(".error").removeClass("error"),e.find(".upload__errorList").addClass("hide").empty(),e.find(".hide-on-open").hide(),e.find(".tooltip").remove()}},$.upload.init=function(){var e="/"+ADMIN_DIR+"/meta/fileUpload";$(".js-fileupload").each(function(t,n){return function(t){var n=$(t),a=n.find(".js-fileupload-control").attr("id"),i=n.find(".js-fileupload-group").val(),o=n.find(".js-fileupload-settings").val();n.find(".js-fileupload-group").attr("name");n.data("action")&&(e=n.data("action"));var l=new qq.FineUploader({debug:!1,multiple:!0,element:document.getElementById(a),template:"upload-template",request:{accessKey:"file_key",endpoint:e,inputName:"file",includeExif:!1,defaultQuality:100,params:{groupid:i,settings:o}},deleteFile:{enabled:!0,forceConfirm:!1,endpoint:"/"+ADMIN_DIR+"/meta/filedelete"},thumbnails:{placeholders:{waitingPath:"/"+ADMIN_DIR+"/images/fine-uploader/waiting-generic.png",notAvailablePath:"/"+ADMIN_DIR+"/images/fine-uploader/not_available-generic.png"}},validation:{itemLimit:0,sizeLimit:2048e3},callbacks:{onComplete:function(e,t,n){this.setUuid(e,n.id)}}});l.addInitialFiles(initialFiles[i]||[]),n.on("click",".qq-upload-file-selector",function(e){e.preventDefault();var t=$(this).text(),n=$(this).closest(".attachments-list__item").index(),a=l.getUuid(n),i=Module.changeFileName(a,t);i&&l.setName(n,i)})}(n)})}});var d=document;$(document).ready(function(){selectize(),datepicker(),metaCounter(),seoCrowl(),keyControls(),on_load(),cp.dropdown(),cp.tableToggleList(),cp.cleditor(),jscolor.install()});