"use strict";var shopping=function(e){function t(){var e={};return location.search.substr(1).split("&").forEach(function(t){var a=t.split("=");e[a[0]]=encodeURI(unescape(unescape(a[1])))}),e}function a(e,a){var n=t();return n[e]=a,n}function n(e){var t=[];return Object.keys(e).map(function(a){"undefined"!==e[a]&&""!==e[a]&&t.push([a,e[a]].join("="))}),t.join("&")}function o(e){if(Object.keys(e).length){var t="",a=["page","backuri"];Object.keys(e).map(function(n){a.indexOf(n)<0&&"undefined"!==e[n]&&""!==e[n]&&(""!==t&&(t+="&"),t+=[n,e[n]].join("="))}),location.href="/"+ADMIN_DIR+"/shopping/catalog?"+t}}return{tab:function(t,a){e(".tabs__list__link").removeClass("tabs__list__link_current"),e(".catalog-tabs__item").removeClass("current"),e(t).addClass("tabs__list__link_current"),e("#tab-"+a).addClass("current")},sort:function(e){var o=t();if(void 0!==o.sort){var c=o.sort.split("-")[1];c="asc"===c?"desc":"asc",location.search=n(a("sort",e+"-"+c))}else location.search=n(a("sort",e+"-asc"))},search:function(e,t,n,c){n?13==c.keyCode&&o(a(e,t)):o(a(e,t))},reload:function(){var e=t();if(void 0!==e.page){var a=e.page-1>=0?e.page-1:"";a?location.search="page="+a:location.reload()}else location.reload()},setLimit:function(t,a){var n=parseInt(a.value);if(n>0){var o=["module","pages",t].join("_");e.removeCookie(o),e.cookie(o,n,{expires:30,path:"/"}),setTimeout(function(){location.reload()},50)}},generateMeta:function(){},requestBalance:function(t,a){e.ajax({url:["/",ADMIN_DIR,"/shopping/set/balance"].join(""),type:"post",data:a,dataType:"JSON",success:function(e){t.prop("disabled",a.disabled),void 0===a.disabled||a.disabled||t.focus()}})},inputBalance:function(t){var a=e("#balance-"+t),n=a.val();this.requestBalance(a,{id:t,value:n})},changeBalance:function(t){var a=t.value,n=e("#balance-"+a),o=n.val(),c=t.checked;this.requestBalance(n,{id:a,value:o,disabled:c?1:0})},update:function(t,a,n){var o=Number(t.target.checked);e.ajax({url:["/",ADMIN_DIR,"/shopping/update"].join(""),type:"post",data:{id:n,name:a,value:o},dataType:"JSON",success:function(e){}})},checkByName:function(t){var a=e(t).val(),n=e(t).prop("checked");e('.check-all-spy[name="'+a+'"]').prop("checked",n)},checkAll:function(t){var a=e(t).prop("checked");e(".check-all-spy").prop("checked",a),a?e("#remove-button").addClass("enable"):e("#remove-button").removeClass("enable")},checkItem:function(t){e(".check-all-spy:checked").length?e("#remove-button").addClass("enable"):e("#remove-button").removeClass("enable")},deleteManufacturer:function(t,a){t.preventDefault(),cp.dialog("Вы действительно хотите удалить производителя?")&&e.ajax({url:["/",ADMIN_DIR,"/shopping/manufacturer/del/",a].join(""),type:"get",dataType:"JSON",success:function(){e("#module-table").find('.module-table__row[data-id="'+a+'"]').remove(),cp.notify("Производитель удален","info")}})},deleteProduct:function(e,t){e.preventDefault(),cp.dialog("Вы действительно хотите удалить товар?")&&this.deleteItem(t,!0)},deleteItem:function(t,a){e.ajax({url:["/",ADMIN_DIR,"/shopping/catalog/del/",t].join(""),type:"get",dataType:"JSON",success:function(){e("#module-table").find('.module-table__row[data-id="'+t+'"]').remove(),a&&cp.notify("Товар удален","info")}})},deleteAll:function(t){t.preventDefault();var a=e(".check-all-spy:checked").length,n=e(".check-all-spy").length;if(a){var o=this;cp.dialog(["Вы действительно хотите удалить ",declOfNum(a,["товар","товара","товаров"]),"?"].join(""))&&e(".check-all-spy:checked").each(function(t,c){o.deleteItem(parseInt(e(c).val()),!1),t+1==a&&(cp.notify(["Удалено ",declOfNum(a,["товар","товара","товаров"])].join(""),"info"),setTimeout(function(){a==n?o.reload():location.reload()},150))})}}}}(jQuery),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},orders=function(e){return{toggle:function(t,a,n,o){if(e("#"+a).length&&e("#"+a).toggleClass(n),"boolean"==typeof o&&!0===o&&e(t).remove(),"object"===(void 0===o?"undefined":_typeof(o))){var c=e("#"+a).hasClass(n)?0:1;e(t).text(o[c])}},deleteItem:function(t,a){e.ajax({url:["/",ADMIN_DIR,"/shopping/orders/del/",t].join(""),type:"get",dataType:"JSON",success:function(){e("#module-table").find('.module-table__row[data-id="'+t+'"]').remove(),a&&cp.notify("Товар удален","info")}})},deleteAll:function(t){t.preventDefault();var a=e(".check-all-spy:checked").length,n=e(".check-all-spy").length;if(a){var o=this;cp.dialog(["Вы действительно хотите удалить ",declOfNum(a,["заказ","заказа","заказов"]),"?"].join(""))&&e(".check-all-spy:checked").each(function(t,c){o.deleteItem(parseInt(e(c).val()),!1),t+1==a&&(cp.notify(["Удалено ",declOfNum(a,["заказ","заказа","заказов"])].join(""),"info"),setTimeout(function(){a==n?shopping.reload():location.reload()},150))})}}}}(jQuery);