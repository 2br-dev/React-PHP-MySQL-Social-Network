"use strict";var Module=function(e){function t(){var e={};return location.search.substr(1).split("&").forEach(function(t){var o=t.split("=");e[o[0]]=encodeURI(unescape(unescape(o[1])))}),e}function o(e,o){var a=t();return a[e]=o,a}function a(e){var t=[];return Object.keys(e).map(function(o){"undefined"!==e[o]&&""!==e[o]&&t.push([o,e[o]].join("="))}),t.join("&")}function n(e){if(Object.keys(e).length){var t="";Object.keys(e).map(function(o){"page"!==o&&"undefined"!==e[o]&&""!==e[o]&&(""!==t&&(t+="&"),t+=[o,e[o]].join("="))}),location.search=t}}return{changeFileName:function(t,o){if(void 0!==t&&void 0!==o){var a=prompt("Введите новое имя",o);if(""!==a&&a!==o&&null!==a)return e.ajax({url:"/"+ADMIN_DIR+"/meta/filename",type:"POST",data:{id:t,name:a}}),a}return!1},ajaxFileDelete:function(t,o){return cp.dialog("Вы дейсвительно хотите удалить файл?")&&e.ajax({url:"/"+ADMIN_DIR+"/meta/filedelete",type:"post",data:{id:t},dataType:"JSON",success:function(t){!0===t.status&&e("#"+o).remove()}}),!1},sort:function(e){var n=t();if(void 0!==n.sort){var i=n.sort.split("-")[1];i="asc"===i?"desc":"asc",location.search=a(o("sort",e+"-"+i))}else location.search=a(o("sort",e+"-asc"))},search:function(e,t,a,i){a?13==i.keyCode&&n(o(e,t)):n(o(e,t))},reload:function(){var e=t();if(void 0!==e.page){var o=e.page-1>=0?e.page-1:"";o?location.search="page="+o:location.reload()}else location.reload()},setSort:function(t,o,a){var n=["module","sorted",o].join("_"),i=t.value,c=e.cookie(n);if(c){var r=[],l=unserialize(c);"undefined"==l[o]?(r[o]={},r[o][a]=i):(l[o][a],l[o][a]=i,r=l),e.removeCookie(n),e.cookie(n,serialize(r),{expires:30,path:"/"})}else{var u=[];u[o]={},u[o][a]=i,e.cookie(n,serialize(u),{expires:30,path:"/"})}setTimeout(function(){location.reload()},50)},setLimit:function(t,o){var a=["module","limit",o].join("_"),n=parseInt(t.value);e.removeCookie(a),e.cookie(a,n,{expires:30,path:"/"}),setTimeout(function(){location.reload()},50)},update:function(t,o,a){var n=Number(t.target.checked);e.ajax({url:["/",ADMIN_DIR,"/shopping/update"].join(""),type:"post",data:{id:a,name:o,value:n},dataType:"JSON",success:function(e){}})},checkAll:function(t){var o=e(t).prop("checked");e(".check-all-spy").prop("checked",o),o?e("#remove-button").addClass("enable"):e("#remove-button").removeClass("enable")},checkItem:function(t){e(".check-all-spy:checked").length?e("#remove-button").addClass("enable"):e("#remove-button").removeClass("enable")},deleteQuestion:function(t,o){t.preventDefault();if(cp.dialog("Вы действительно хотите удалить позицию?")){var a=e(o).attr("href");e.post(a,function(){cp.notify("Позиция удалена","info"),e(o).closest("tr").remove()})}return!1},deleteItem:function(t,o,a){e.ajax({url:"/"+ADMIN_DIR+"/meta/module/del/"+o+"/"+t,type:"post",data:{id:t,module:o},dataType:"JSON",success:function(){e("#module-table").find('.module-table__row[data-id="'+t+'"]').remove(),a&&cp.notify("Позиция удалена","info")}})},deleteAll:function(t){t.preventDefault();var o=e(".check-all-spy:checked").length,a=e(".check-all-spy").length;if(o){var n=this;cp.dialog(["Вы действительно хотите удалить ",declOfNum(o,["позиция","позиций","позиции"]),"?"].join(""))&&e(".check-all-spy:checked").each(function(t,i){var c=e(i).val().split("_");n.deleteItem(parseInt(c[0]),parseInt(c[1]),!1),t+1==o&&(cp.notify(["Удалено ",declOfNum(o,["позиция","позиций","позиции"])].join(""),"info"),setTimeout(function(){o==a?n.reload():location.reload()},150))})}}}}(jQuery),structure=(jQuery,{});